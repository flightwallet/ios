<!DOCTYPE html>
<html>
    <head>
        <script>
            function hideText() {
                document.getElementById("demo").style.display = "none";
            }
        
        function showText() {
            document.getElementById("demo").style.display = "block";
            window.webkit.messageHandlers.jsHandler.postMessage("trigger from JS");
            
            window.webkit.messageHandlers.updateApplicationState.postMessage("trigger from JS")
            
            setInterval(function () {
                        
                        window.webkit.messageHandlers.updateApplicationState.postMessage(Date.now())
            }, 1000);
        }
        
        
        function getBTCAddress(priv) {
            if (!priv) return
            
            const key = bitcoin.ECPair.fromWIF(priv, bitcoin.networks.testnet)
            
            const address = bitcoin.payments.p2pkh({ pubkey: key.publicKey, network: bitcoin.networks.testnet }).address
            
            document.getElementById("demo").innerHTML = "Address: " + address
            
            return address
        }
        
        function getAddress(priv) {
            if (!priv) return 
            
            const _priv = ethereumjs.Buffer.Buffer.from(priv, "hex")
            const wallet = ethereumjs.Wallet.fromPrivateKey(_priv)
            
            const address = wallet.getAddressString()
            document.getElementById("demo").innerHTML = "Address: " + address
            return address
        }
        
        function signTx(txRaw, priv) {
            const tx = new ethereumjs.Tx(txRaw)
            
            const _priv = ethereumjs.Buffer.Buffer.from(priv, "hex")
            
            tx.sign(_priv)
            
            return tx.serialize()
        }
        
        function call(handler, message) {
            window.webkit.messageHandlers[Handler].postMessage(message)
        }
        
        </script>
        
        <script src="bitcoinjs-lib-4.0.2.js"></script>
        <script src="ethereumjs-tx-1.3.3.js"></script>
        <script src="ethereumjs-wallet-hd-0.6.0.js"></script>
    </head>
    <body>
        <h1 id="demo">FLIGHT.WALLET</h1>
<!--        -->
<!--        -->
<!--        <input type="button" onclick="generate()" value="Show Text and Trigger Handler">-->
<!--            -->
<!--        <input type="button" onclick="showText()" value="Show Text and Trigger Handler">-->
<!--        <input type="button" onclick="hideText()" value="Hide Text">-->
    </body>
</html>
